# -*- coding: utf-8 -*-

# Form implementation generated from reading ui file 'showpanel.ui'
#
# Created by: PyQt5 UI code generator 5.15.9
#
# WARNING: Any manual changes made to this file will be lost when pyuic5 is
# run again.  Do not edit this file unless you know what you are doing.


import sys

from PyQt5.QtGui import QPixmap
from 数据分析 import cityDict
from 数据分析.数据可视化 import *
from PyQt5.QtWidgets import *
from PyQt5 import QtCore, QtGui, QtWidgets

from 界面 import picshow


class pic_window(picshow.Ui_picwid, QWidget):
    def __init__(self):
        super(pic_window, self).__init__()
        self.setupUi(self)

class Ui_showwid(QWidget):
    app = QtWidgets.QApplication(sys.argv)
    pic_window = pic_window()
    def setupUi(self, showwid):
        showwid.setObjectName("showwid")
        showwid.resize(1650, 1000)
        self.gridLayout = QtWidgets.QGridLayout(showwid)
        self.gridLayout.setObjectName("gridLayout")
        self.begindayedit = QtWidgets.QDateEdit(showwid)
        self.begindayedit.setMaximumSize(QtCore.QSize(200, 100))
        font = QtGui.QFont()
        font.setPointSize(16)
        self.begindayedit.setFont(font)
        self.begindayedit.setMaximumDateTime(QtCore.QDateTime(QtCore.QDate(2023, 6, 21), QtCore.QTime(23, 59, 59)))
        self.begindayedit.setMinimumDateTime(QtCore.QDateTime(QtCore.QDate(2010, 1, 1), QtCore.QTime(0, 0, 0)))
        self.begindayedit.setObjectName("begindayedit")
        self.gridLayout.addWidget(self.begindayedit, 1, 1, 1, 1)
        self.querybut = QtWidgets.QPushButton(showwid)
        self.querybut.setMaximumSize(QtCore.QSize(200, 100))
        font = QtGui.QFont()
        font.setPointSize(16)
        self.querybut.setFont(font)
        self.querybut.setObjectName("querybut")
        self.gridLayout.addWidget(self.querybut, 3, 1, 1, 1)
        self.cityedit = QtWidgets.QPlainTextEdit(showwid)
        self.cityedit.setMaximumSize(QtCore.QSize(150, 50))
        font = QtGui.QFont()
        font.setPointSize(18)
        self.cityedit.setFont(font)
        self.cityedit.setObjectName("cityedit")
        self.gridLayout.addWidget(self.cityedit, 0, 1, 1, 1)
        self.showtab = QtWidgets.QTableWidget(showwid)
        self.showtab.setMaximumSize(QtCore.QSize(2000, 16777215))
        font = QtGui.QFont()
        font.setPointSize(12)
        self.showtab.setFont(font)
        self.showtab.setObjectName("showtab")
        self.showtab.setColumnCount(10)
        item = QtWidgets.QTableWidgetItem()
        self.showtab.setVerticalHeaderItem(0, item)
        item = QtWidgets.QTableWidgetItem()
        self.showtab.setHorizontalHeaderItem(0, item)
        item = QtWidgets.QTableWidgetItem()
        self.showtab.setHorizontalHeaderItem(1, item)
        item = QtWidgets.QTableWidgetItem()
        self.showtab.setHorizontalHeaderItem(2, item)
        item = QtWidgets.QTableWidgetItem()
        self.showtab.setHorizontalHeaderItem(3, item)
        item = QtWidgets.QTableWidgetItem()
        self.showtab.setHorizontalHeaderItem(4, item)
        item = QtWidgets.QTableWidgetItem()
        self.showtab.setHorizontalHeaderItem(5, item)
        item = QtWidgets.QTableWidgetItem()
        self.showtab.setHorizontalHeaderItem(6, item)
        item = QtWidgets.QTableWidgetItem()
        self.showtab.setHorizontalHeaderItem(7, item)
        item = QtWidgets.QTableWidgetItem()
        self.showtab.setHorizontalHeaderItem(8, item)
        item = QtWidgets.QTableWidgetItem()
        self.showtab.setHorizontalHeaderItem(9, item)
        self.gridLayout.addWidget(self.showtab, 0, 4, 8, 1)
        self.pushButton = QtWidgets.QPushButton(showwid)
        self.pushButton.setMinimumSize(QtCore.QSize(150, 50))
        font = QtGui.QFont()
        font.setPointSize(16)
        self.pushButton.setFont(font)
        self.pushButton.setObjectName("pushButton")
        self.gridLayout.addWidget(self.pushButton, 5, 1, 1, 1)
        self.enddayedit = QtWidgets.QDateEdit(showwid)
        self.enddayedit.setMaximumSize(QtCore.QSize(200, 100))
        font = QtGui.QFont()
        font.setPointSize(16)
        self.enddayedit.setFont(font)
        self.enddayedit.setMaximumDateTime(QtCore.QDateTime(QtCore.QDate(2023, 6, 21), QtCore.QTime(23, 59, 59)))
        self.enddayedit.setMinimumDateTime(QtCore.QDateTime(QtCore.QDate(2010, 1, 1), QtCore.QTime(0, 0, 0)))
        self.enddayedit.setObjectName("enddayedit")
        self.gridLayout.addWidget(self.enddayedit, 2, 1, 1, 1)
        spacerItem = QtWidgets.QSpacerItem(20, 20, QtWidgets.QSizePolicy.Minimum, QtWidgets.QSizePolicy.Expanding)
        self.gridLayout.addItem(spacerItem, 7, 2, 1, 1)
        self.startdaylab = QtWidgets.QLabel(showwid)
        self.startdaylab.setMaximumSize(QtCore.QSize(200, 100))
        font = QtGui.QFont()
        font.setPointSize(16)
        self.startdaylab.setFont(font)
        self.startdaylab.setObjectName("startdaylab")
        self.gridLayout.addWidget(self.startdaylab, 1, 0, 1, 1)
        self.enddaylab = QtWidgets.QLabel(showwid)
        self.enddaylab.setMaximumSize(QtCore.QSize(200, 100))
        font = QtGui.QFont()
        font.setPointSize(16)
        self.enddaylab.setFont(font)
        self.enddaylab.setObjectName("enddaylab")
        self.gridLayout.addWidget(self.enddaylab, 2, 0, 1, 1)
        self.indexbox = QtWidgets.QComboBox(showwid)
        self.indexbox.setMinimumSize(QtCore.QSize(100, 50))
        self.indexbox.setMaximumSize(QtCore.QSize(150, 16777215))
        font = QtGui.QFont()
        font.setPointSize(16)
        self.indexbox.setFont(font)
        self.indexbox.setObjectName("indexbox")
        self.indexbox.addItem("")
        self.indexbox.addItem("")
        self.indexbox.addItem("")
        self.indexbox.addItem("")
        self.indexbox.addItem("")
        self.indexbox.addItem("")
        self.indexbox.addItem("")
        self.indexbox.addItem("")
        self.gridLayout.addWidget(self.indexbox, 5, 0, 1, 1)
        self.citylab = QtWidgets.QLabel(showwid)
        self.citylab.setMaximumSize(QtCore.QSize(100, 100))
        font = QtGui.QFont()
        font.setPointSize(16)
        self.citylab.setFont(font)
        self.citylab.setObjectName("citylab")
        self.gridLayout.addWidget(self.citylab, 0, 0, 1, 1)
        self.label = QtWidgets.QLabel(showwid)
        font = QtGui.QFont()
        font.setPointSize(16)
        self.label.setFont(font)
        self.label.setObjectName("label")
        self.gridLayout.addWidget(self.label, 4, 0, 1, 1)

        self.pushButton.clicked.connect(self.show_pic)
        self.querybut.clicked.connect(self.show_list)

        self.retranslateUi(showwid)
        QtCore.QMetaObject.connectSlotsByName(showwid)

    def retranslateUi(self, showwid):
        _translate = QtCore.QCoreApplication.translate
        showwid.setWindowTitle(_translate("showwid", "城市空气指标展示"))
        self.querybut.setText(_translate("showwid", "查询"))
        item = self.showtab.horizontalHeaderItem(0)
        item.setText(_translate("showwid", "序号"))
        item = self.showtab.horizontalHeaderItem(1)
        item.setText(_translate("showwid", "日期"))
        item = self.showtab.horizontalHeaderItem(2)
        item.setText(_translate("showwid", "AQI指数"))
        item = self.showtab.horizontalHeaderItem(3)
        item.setText(_translate("showwid", "当天AQI排名"))
        item = self.showtab.horizontalHeaderItem(4)
        item.setText(_translate("showwid", "PM2.5"))
        item = self.showtab.horizontalHeaderItem(5)
        item.setText(_translate("showwid", "PM10"))
        item = self.showtab.horizontalHeaderItem(6)
        item.setText(_translate("showwid", "So2"))
        item = self.showtab.horizontalHeaderItem(7)
        item.setText(_translate("showwid", "No2"))
        item = self.showtab.horizontalHeaderItem(8)
        item.setText(_translate("showwid", "Co"))
        item = self.showtab.horizontalHeaderItem(9)
        item.setText(_translate("showwid", "O3"))
        self.pushButton.setText(_translate("showwid", "展示"))
        self.startdaylab.setText(_translate("showwid", "开始时间"))
        self.enddaylab.setText(_translate("showwid", "结束时间"))
        self.indexbox.setItemText(0, _translate("showwid", "AQI指数"))
        self.indexbox.setItemText(1, _translate("showwid", "当天AQI排名"))
        self.indexbox.setItemText(2, _translate("showwid", "PM2.5"))
        self.indexbox.setItemText(3, _translate("showwid", "PM10"))
        self.indexbox.setItemText(4, _translate("showwid", "So2"))
        self.indexbox.setItemText(5, _translate("showwid", "No2"))
        self.indexbox.setItemText(6, _translate("showwid", "Co"))
        self.indexbox.setItemText(7, _translate("showwid", "O3"))
        self.citylab.setText(_translate("showwid", "城市"))
        self.label.setText(_translate("showwid", "趋势折线图"))

    def show_pic(self):
        start = self.begindayedit.text()
        end = self.enddayedit.text()
        city = self.cityedit.toPlainText().split(" ")[0]
        type = self.indexbox.currentText()
        # print(city, type, start, end)
        draw_plot(city, type, start, end)
        pixmap = QPixmap("plot.jpg")
        self.pic_window.pic.setPixmap(pixmap)
        # start = self.startdaylab
        self.pic_window.show()

    def show_list(self):
        start = self.begindayedit.text()
        end = self.enddayedit.text()
        city = self.cityedit.toPlainText().split(" ")[0]
        city = cityDict.pinyin_to_city(city)
        items = query_all(city, start, end)
        for obj in items:
            row = self.showtab.rowCount()
            self.showtab.insertRow(row)
            for j in range(0, 10):
                item1 = QtWidgets.QTableWidgetItem(str(obj[j]))
                self.showtab.setItem(row, j, item1)
if __name__=="__main__":
    app=QtWidgets.QApplication(sys.argv)
    MainWindow = QWidget()
    ui=Ui_showwid()
    ui.setupUi(MainWindow)
    MainWindow.show()
    sys.exit(app.exec())