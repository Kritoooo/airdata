# -*- coding: utf-8 -*-

# Form implementation generated from reading ui file 'showpanel.ui'
#
# Created by: PyQt5 UI code generator 5.15.9
#
# WARNING: Any manual changes made to this file will be lost when pyuic5 is
# run again.  Do not edit this file unless you know what you are doing.


import sys
from 数据分析 import 预处理
from PyQt5.QtGui import QPixmap
from 数据分析 import cityDict
from 数据分析.数据可视化 import *
from PyQt5.QtWidgets import *
from PyQt5 import QtCore, QtGui, QtWidgets

from 界面 import picshow

class pic_window(picshow.Ui_picwid, QWidget):
    def __init__(self):
        super(pic_window, self).__init__()
        self.setupUi(self)

class Ui_showwid(QWidget):
    app = QtWidgets.QApplication(sys.argv)
    pic_window = pic_window()
    def setupUi(self, showwid):
        showwid.setObjectName("showwid")
        showwid.resize(1202, 868)
        showwid.setMaximumSize(QtCore.QSize(2000, 2000))
        font = QtGui.QFont()
        font.setPointSize(16)
        showwid.setFont(font)
        showwid.setStyleSheet("border-image: url(:/nuan.jpg);")
        self.gridLayout = QtWidgets.QGridLayout(showwid)
        self.gridLayout.setObjectName("gridLayout")
        self.indexbox = QtWidgets.QComboBox(showwid)
        self.indexbox.setMinimumSize(QtCore.QSize(100, 50))
        self.indexbox.setMaximumSize(QtCore.QSize(150, 16777215))
        font = QtGui.QFont()
        font.setPointSize(16)
        self.indexbox.setFont(font)
        self.indexbox.setStyleSheet("border-image: url(:/R.jpg);border-image: url(:/R.jpg);")
        self.indexbox.setObjectName("indexbox")
        self.indexbox.addItem("")
        self.indexbox.addItem("")
        self.indexbox.addItem("")
        self.indexbox.addItem("")
        self.indexbox.addItem("")
        self.indexbox.addItem("")
        self.indexbox.addItem("")
        self.indexbox.addItem("")
        self.gridLayout.addWidget(self.indexbox, 9, 0, 1, 1)
        self.sortbox = QtWidgets.QComboBox(showwid)
        self.sortbox.setMinimumSize(QtCore.QSize(100, 50))
        self.sortbox.setMaximumSize(QtCore.QSize(16777215, 50))
        font = QtGui.QFont()
        font.setPointSize(16)
        self.sortbox.setFont(font)
        self.sortbox.setStyleSheet("border-image: url(:/R.jpg);")
        self.sortbox.setObjectName("sortbox")
        self.sortbox.addItem("")
        self.sortbox.addItem("")
        self.gridLayout.addWidget(self.sortbox, 5, 1, 1, 1)
        self.line_3 = QtWidgets.QFrame(showwid)
        self.line_3.setFrameShape(QtWidgets.QFrame.HLine)
        self.line_3.setFrameShadow(QtWidgets.QFrame.Sunken)
        self.line_3.setObjectName("line_3")
        self.gridLayout.addWidget(self.line_3, 10, 0, 1, 2)
        self.pushButton_3 = QtWidgets.QPushButton(showwid)
        self.pushButton_3.setMinimumSize(QtCore.QSize(100, 50))
        font = QtGui.QFont()
        font.setPointSize(16)
        self.pushButton_3.setFont(font)
        self.pushButton_3.setStyleSheet("border-image: url(:/R.jpg);")
        self.pushButton_3.setObjectName("pushButton_3")
        self.gridLayout.addWidget(self.pushButton_3, 12, 1, 1, 1)
        self.label_3 = QtWidgets.QLabel(showwid)
        font = QtGui.QFont()
        font.setPointSize(16)
        self.label_3.setFont(font)
        self.label_3.setStyleSheet("border-image: url(:/R.jpg);")
        self.label_3.setObjectName("label_3")
        self.gridLayout.addWidget(self.label_3, 14, 0, 1, 1)
        self.cityedit = QtWidgets.QPlainTextEdit(showwid)
        self.cityedit.setMaximumSize(QtCore.QSize(150, 50))
        font = QtGui.QFont()
        font.setPointSize(18)
        self.cityedit.setFont(font)
        self.cityedit.setStyleSheet("border-image: url(:/R.jpg);")
        self.cityedit.setObjectName("cityedit")
        self.gridLayout.addWidget(self.cityedit, 0, 1, 1, 1)
        self.line = QtWidgets.QFrame(showwid)
        self.line.setFrameShape(QtWidgets.QFrame.HLine)
        self.line.setFrameShadow(QtWidgets.QFrame.Sunken)
        self.line.setObjectName("line")
        self.gridLayout.addWidget(self.line, 3, 0, 1, 2)
        self.citylab = QtWidgets.QLabel(showwid)
        self.citylab.setMinimumSize(QtCore.QSize(0, 50))
        self.citylab.setMaximumSize(QtCore.QSize(100, 50))
        font = QtGui.QFont()
        font.setPointSize(16)
        self.citylab.setFont(font)
        self.citylab.setStyleSheet("border-image: url(:/R.jpg);")
        self.citylab.setObjectName("citylab")
        self.gridLayout.addWidget(self.citylab, 0, 0, 1, 1)
        self.label = QtWidgets.QLabel(showwid)
        self.label.setMaximumSize(QtCore.QSize(16777215, 50))
        font = QtGui.QFont()
        font.setPointSize(16)
        self.label.setFont(font)
        self.label.setStyleSheet("border-image: url(:/R.jpg);")
        self.label.setObjectName("label")
        self.gridLayout.addWidget(self.label, 8, 0, 1, 1)
        self.enddaylab = QtWidgets.QLabel(showwid)
        self.enddaylab.setMinimumSize(QtCore.QSize(0, 50))
        self.enddaylab.setMaximumSize(QtCore.QSize(200, 50))
        font = QtGui.QFont()
        font.setPointSize(16)
        self.enddaylab.setFont(font)
        self.enddaylab.setStyleSheet("border-image: url(:/R.jpg);")
        self.enddaylab.setObjectName("enddaylab")
        self.gridLayout.addWidget(self.enddaylab, 2, 0, 1, 1)
        self.line_4 = QtWidgets.QFrame(showwid)
        self.line_4.setFrameShape(QtWidgets.QFrame.HLine)
        self.line_4.setFrameShadow(QtWidgets.QFrame.Sunken)
        self.line_4.setObjectName("line_4")
        self.gridLayout.addWidget(self.line_4, 13, 0, 1, 2)
        self.label_2 = QtWidgets.QLabel(showwid)
        self.label_2.setMaximumSize(QtCore.QSize(16777215, 50))
        font = QtGui.QFont()
        font.setPointSize(16)
        self.label_2.setFont(font)
        self.label_2.setStyleSheet("border-image: url(:/R.jpg);")
        self.label_2.setObjectName("label_2")
        self.gridLayout.addWidget(self.label_2, 11, 0, 1, 1)
        self.querybut = QtWidgets.QPushButton(showwid)
        self.querybut.setMinimumSize(QtCore.QSize(100, 50))
        self.querybut.setMaximumSize(QtCore.QSize(200, 50))
        font = QtGui.QFont()
        font.setPointSize(16)
        self.querybut.setFont(font)
        self.querybut.setStyleSheet("border-image: url(:/R.jpg);")
        self.querybut.setObjectName("querybut")
        self.gridLayout.addWidget(self.querybut, 6, 1, 1, 1)
        self.startdaylab = QtWidgets.QLabel(showwid)
        self.startdaylab.setMinimumSize(QtCore.QSize(0, 50))
        self.startdaylab.setMaximumSize(QtCore.QSize(200, 50))
        font = QtGui.QFont()
        font.setPointSize(16)
        self.startdaylab.setFont(font)
        self.startdaylab.setStyleSheet("border-image: url(:/R.jpg);")
        self.startdaylab.setObjectName("startdaylab")
        self.gridLayout.addWidget(self.startdaylab, 1, 0, 1, 1)
        self.enddayedit = QtWidgets.QDateEdit(showwid)
        self.enddayedit.setMaximumSize(QtCore.QSize(200, 50))
        font = QtGui.QFont()
        font.setPointSize(16)
        self.enddayedit.setFont(font)
        self.enddayedit.setStyleSheet("border-image: url(:/R.jpg);")
        self.enddayedit.setMaximumDateTime(QtCore.QDateTime(QtCore.QDate(2023, 6, 21), QtCore.QTime(23, 59, 59)))
        self.enddayedit.setMinimumDateTime(QtCore.QDateTime(QtCore.QDate(2010, 1, 1), QtCore.QTime(0, 0, 0)))
        self.enddayedit.setObjectName("enddayedit")
        self.gridLayout.addWidget(self.enddayedit, 2, 1, 1, 1)
        self.comboBox = QtWidgets.QComboBox(showwid)
        self.comboBox.setMinimumSize(QtCore.QSize(100, 50))
        font = QtGui.QFont()
        font.setPointSize(16)
        self.comboBox.setFont(font)
        self.comboBox.setStyleSheet("border-image: url(:/R.jpg);")
        self.comboBox.setObjectName("comboBox")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.gridLayout.addWidget(self.comboBox, 12, 0, 1, 1)
        self.pushButton = QtWidgets.QPushButton(showwid)
        self.pushButton.setMinimumSize(QtCore.QSize(150, 50))
        font = QtGui.QFont()
        font.setPointSize(16)
        self.pushButton.setFont(font)
        self.pushButton.setStyleSheet("border-image: url(:/R.jpg);")
        self.pushButton.setObjectName("pushButton")
        self.gridLayout.addWidget(self.pushButton, 9, 1, 1, 1)
        self.begindayedit = QtWidgets.QDateEdit(showwid)
        self.begindayedit.setMaximumSize(QtCore.QSize(200, 50))
        font = QtGui.QFont()
        font.setPointSize(16)
        self.begindayedit.setFont(font)
        self.begindayedit.setStyleSheet("border-image: url(:/R.jpg);")
        self.begindayedit.setMaximumDateTime(QtCore.QDateTime(QtCore.QDate(2023, 6, 21), QtCore.QTime(23, 59, 59)))
        self.begindayedit.setMinimumDateTime(QtCore.QDateTime(QtCore.QDate(2010, 1, 1), QtCore.QTime(0, 0, 0)))
        self.begindayedit.setObjectName("begindayedit")
        self.gridLayout.addWidget(self.begindayedit, 1, 1, 1, 1)
        self.pushButton_2 = QtWidgets.QPushButton(showwid)
        self.pushButton_2.setMinimumSize(QtCore.QSize(100, 50))
        font = QtGui.QFont()
        font.setPointSize(16)
        self.pushButton_2.setFont(font)
        self.pushButton_2.setStyleSheet("border-image: url(:/R.jpg);")
        self.pushButton_2.setObjectName("pushButton_2")
        self.gridLayout.addWidget(self.pushButton_2, 14, 1, 1, 1)
        self.rankbox = QtWidgets.QComboBox(showwid)
        self.rankbox.setMinimumSize(QtCore.QSize(100, 50))
        self.rankbox.setMaximumSize(QtCore.QSize(150, 50))
        font = QtGui.QFont()
        font.setPointSize(16)
        self.rankbox.setFont(font)
        self.rankbox.setStyleSheet("border-image: url(:/R.jpg);")
        self.rankbox.setObjectName("rankbox")
        self.rankbox.addItem("")
        self.rankbox.addItem("")
        self.rankbox.addItem("")
        self.rankbox.addItem("")
        self.rankbox.addItem("")
        self.rankbox.addItem("")
        self.rankbox.addItem("")
        self.rankbox.addItem("")
        self.gridLayout.addWidget(self.rankbox, 4, 1, 1, 1)
        self.sortlab = QtWidgets.QLabel(showwid)
        self.sortlab.setMinimumSize(QtCore.QSize(100, 50))
        self.sortlab.setMaximumSize(QtCore.QSize(200, 50))
        font = QtGui.QFont()
        font.setPointSize(16)
        self.sortlab.setFont(font)
        self.sortlab.setStyleSheet("border-image: url(:/R.jpg);")
        self.sortlab.setObjectName("sortlab")
        self.gridLayout.addWidget(self.sortlab, 5, 0, 1, 1)
        self.line_2 = QtWidgets.QFrame(showwid)
        self.line_2.setFrameShape(QtWidgets.QFrame.HLine)
        self.line_2.setFrameShadow(QtWidgets.QFrame.Sunken)
        self.line_2.setObjectName("line_2")
        self.gridLayout.addWidget(self.line_2, 7, 0, 1, 2)
        self.ranklab = QtWidgets.QLabel(showwid)
        self.ranklab.setMinimumSize(QtCore.QSize(100, 50))
        self.ranklab.setMaximumSize(QtCore.QSize(200, 50))
        font = QtGui.QFont()
        font.setPointSize(16)
        self.ranklab.setFont(font)
        self.ranklab.setStyleSheet("border-image: url(:/R.jpg);")
        self.ranklab.setObjectName("ranklab")
        self.gridLayout.addWidget(self.ranklab, 4, 0, 1, 1)
        self.showtab = QtWidgets.QTableWidget(showwid)
        self.showtab.setStyleSheet("border-image: url(:/R.jpg);")
        self.showtab.setMinimumSize(QtCore.QSize(100, 50))
        self.showtab.setMaximumSize(QtCore.QSize(2000, 16777215))
        font = QtGui.QFont()
        font.setPointSize(12)
        self.showtab.setFont(font)
        self.showtab.setObjectName("showtab")
        self.showtab.setColumnCount(10)
        self.showtab.setRowCount(0)
        item = QtWidgets.QTableWidgetItem()
        self.showtab.setHorizontalHeaderItem(0, item)
        item = QtWidgets.QTableWidgetItem()
        self.showtab.setHorizontalHeaderItem(1, item)
        item = QtWidgets.QTableWidgetItem()
        self.showtab.setHorizontalHeaderItem(2, item)
        item = QtWidgets.QTableWidgetItem()
        self.showtab.setHorizontalHeaderItem(3, item)
        item = QtWidgets.QTableWidgetItem()
        self.showtab.setHorizontalHeaderItem(4, item)
        item = QtWidgets.QTableWidgetItem()
        self.showtab.setHorizontalHeaderItem(5, item)
        item = QtWidgets.QTableWidgetItem()
        self.showtab.setHorizontalHeaderItem(6, item)
        item = QtWidgets.QTableWidgetItem()
        self.showtab.setHorizontalHeaderItem(7, item)
        item = QtWidgets.QTableWidgetItem()
        self.showtab.setHorizontalHeaderItem(8, item)
        item = QtWidgets.QTableWidgetItem()
        self.showtab.setHorizontalHeaderItem(9, item)
        self.gridLayout.addWidget(self.showtab, 0, 3, 15, 1)

        # 绑定按钮和函数
        self.pushButton.clicked.connect(self.show_plot_pic)
        self.querybut.clicked.connect(self.show_list)
        self.pushButton_2.clicked.connect(self.show_pie_pic)
        self.pushButton_3.clicked.connect(self.show_hist_pic)

        self.retranslateUi(showwid)
        QtCore.QMetaObject.connectSlotsByName(showwid)

    def retranslateUi(self, showwid):
        _translate = QtCore.QCoreApplication.translate
        showwid.setWindowTitle(_translate("showwid", "城市空气指标展示"))
        self.indexbox.setItemText(0, _translate("showwid", "AQI指数"))
        self.indexbox.setItemText(1, _translate("showwid", "当天AQI排名"))
        self.indexbox.setItemText(2, _translate("showwid", "PM2.5"))
        self.indexbox.setItemText(3, _translate("showwid", "PM10"))
        self.indexbox.setItemText(4, _translate("showwid", "So2"))
        self.indexbox.setItemText(5, _translate("showwid", "No2"))
        self.indexbox.setItemText(6, _translate("showwid", "Co"))
        self.indexbox.setItemText(7, _translate("showwid", "O3"))
        self.sortbox.setItemText(0, _translate("showwid", "从小到大"))
        self.sortbox.setItemText(1, _translate("showwid", "从大到小"))
        self.pushButton_3.setText(_translate("showwid", "展示"))
        self.label_3.setText(_translate("showwid", "贡献柱状图"))
        self.citylab.setText(_translate("showwid", "城市"))
        self.label.setText(_translate("showwid", "趋势折线图"))
        self.enddaylab.setText(_translate("showwid", "结束时间"))
        self.label_2.setText(_translate("showwid", "分布饼状图"))
        self.querybut.setText(_translate("showwid", "查询"))
        self.startdaylab.setText(_translate("showwid", "开始时间"))
        self.comboBox.setItemText(0, _translate("showwid", "AQI指数"))
        self.comboBox.setItemText(1, _translate("showwid", "PM2.5"))
        self.comboBox.setItemText(2, _translate("showwid", "PM10"))
        self.comboBox.setItemText(3, _translate("showwid", "Co2"))
        self.comboBox.setItemText(4, _translate("showwid", "Co"))
        self.comboBox.setItemText(5, _translate("showwid", "O3"))
        self.comboBox.setItemText(6, _translate("showwid", "So2"))
        self.comboBox.setItemText(7, _translate("showwid", "No2"))
        self.pushButton.setText(_translate("showwid", "展示"))
        self.pushButton_2.setText(_translate("showwid", "展示"))
        self.rankbox.setItemText(0, _translate("showwid", "AQI指数"))
        self.rankbox.setItemText(1, _translate("showwid", "当天AQI排名"))
        self.rankbox.setItemText(2, _translate("showwid", "PM2.5"))
        self.rankbox.setItemText(3, _translate("showwid", "PM10"))
        self.rankbox.setItemText(4, _translate("showwid", "So2"))
        self.rankbox.setItemText(5, _translate("showwid", "No2"))
        self.rankbox.setItemText(6, _translate("showwid", "Co"))
        self.rankbox.setItemText(7, _translate("showwid", "O3"))
        self.sortlab.setText(_translate("showwid", "排序方式"))
        self.ranklab.setText(_translate("showwid", "排序指标"))
        item = self.showtab.horizontalHeaderItem(0)
        item.setText(_translate("showwid", "序号"))
        item = self.showtab.horizontalHeaderItem(1)
        item.setText(_translate("showwid", "日期"))
        item = self.showtab.horizontalHeaderItem(2)
        item.setText(_translate("showwid", "AQI指数"))
        item = self.showtab.horizontalHeaderItem(3)
        item.setText(_translate("showwid", "当天AQI排名"))
        item = self.showtab.horizontalHeaderItem(4)
        item.setText(_translate("showwid", "PM2.5"))
        item = self.showtab.horizontalHeaderItem(5)
        item.setText(_translate("showwid", "PM10"))
        item = self.showtab.horizontalHeaderItem(6)
        item.setText(_translate("showwid", "So2"))
        item = self.showtab.horizontalHeaderItem(7)
        item.setText(_translate("showwid", "No2"))
        item = self.showtab.horizontalHeaderItem(8)
        item.setText(_translate("showwid", "Co"))
        item = self.showtab.horizontalHeaderItem(9)
        item.setText(_translate("showwid", "O3"))

    def show_plot_pic(self):
        start = self.begindayedit.text()
        end = self.enddayedit.text()
        city = self.cityedit.toPlainText().split(" ")[0]
        type = self.indexbox.currentText()
        # print(city, type, start, end)
        draw_plot(city, type, start, end)
        pixmap = QPixmap("plot.jpg")
        self.pic_window.pic.setPixmap(pixmap)
        # start = self.startdaylab
        self.pic_window.show()

    def show_pie_pic(self):
        start = self.begindayedit.text()
        end = self.enddayedit.text()
        city = self.cityedit.toPlainText().split(" ")[0]
        type = self.indexbox.currentText()
        # print(city, type, start, end)
        draw_pie(city, type, start, end)
        pixmap = QPixmap("pie.jpg")
        self.pic_window.pic.setPixmap(pixmap)
        # start = self.startdaylab
        self.pic_window.show()

    def show_hist_pic(self):
        start = self.begindayedit.text()
        end = self.enddayedit.text()
        city = self.cityedit.toPlainText().split(" ")[0]
        type = self.indexbox.currentText()
        draw_hist(city, type, start, end)
        pixmap = QPixmap("hist.jpg")
        self.pic_window.pic.setPixmap(pixmap)
        self.pic_window.show()

    def show_list(self):
        start = self.begindayedit.text()
        end = self.enddayedit.text()
        city = self.cityedit.toPlainText().split(" ")[0]
        city = cityDict.pinyin_to_city(city)
        items = query_all(city, start, end)
        for obj in items:
            row = self.showtab.rowCount()
            self.showtab.insertRow(row)
            for j in range(0, 10):
                item1 = QtWidgets.QTableWidgetItem(str(obj[j]))
                self.showtab.setItem(row, j, item1)
import backimage
import cor

if __name__=="__main__":
    app=QtWidgets.QApplication(sys.argv)
    MainWindow = QWidget()
    ui=Ui_showwid()
    ui.setupUi(MainWindow)
    MainWindow.show()
    sys.exit(app.exec())

